# iPhone 二手價格評估系統 - 使用說明

## 📱 系統概述

本系統專門用於評估 **iPhone 二手價格**，透過影像辨識、機器學習和市場資料分析，提供科學化的定價建議。

---

## 🎯 主要功能

### 1. iPhone 型號辨識
- 上傳 iPhone 照片，系統自動辨識是否為 iPhone
- 嘗試識別具體型號（如 iPhone 13、iPhone 14 Pro 等）

### 2. 價格評估
- 根據多項因素評估二手價格：
  - 外觀狀況（1-5分）
  - 保固剩餘月數
  - 螢幕是否破裂
  - 鏡頭是否完好
  - 電池健康度
  - 儲存容量

### 3. 市場參考價格
- 從蝦皮購物和露天拍賣爬取最新五筆參考價格
- 如果爬蟲無法取得資料，會顯示「找不到」而非虛擬資料

### 4. 價格分群分析
- 使用 K-Means 將市場價格分為三個區間：
  - 低價損壞區
  - 合理二手區
  - 高價全新區

---

## 📋 使用步驟

### 步驟 1：準備 iPhone 資料集

首次使用前，需要產生 iPhone 資料集：

```bash
python prepare_iphone_dataset.py
```

這會產生 `iphone.v1.csv` 檔案，包含：
- 各種 iPhone 型號的規格資料
- 模擬的二手價格資料（基於真實規格和折舊計算）

### 步驟 2：啟動系統

```bash
python app.py
```

系統會在 `http://localhost:5000` 啟動

### 步驟 3：上傳照片並填寫資訊

1. **上傳 iPhone 照片**
   - 點擊或拖曳圖片到上傳區域
   - 支援 PNG, JPG, JPEG, GIF, WEBP 格式

2. **填寫 iPhone 狀況**
   - **外觀狀況**：選擇 1-5 分（1=嚴重損壞，5=幾乎全新）
   - **保固剩餘月數**：輸入剩餘保固月數（無保固輸入 0）
   - **螢幕狀況**：選擇螢幕是否破裂
   - **鏡頭狀況**：選擇鏡頭是否完好
   - **電池健康度**：輸入百分比（可在 iPhone 設定中查看）
   - **儲存容量**：選擇 128GB、256GB、512GB 或 1TB

3. **開始評估**
   - 點擊「開始評估」按鈕
   - 系統會自動處理並顯示結果

---

## 📊 結果說明

### 評估結果包含：

1. **辨識資訊**
   - iPhone 型號（如果可辨識）
   - 辨識信心度

2. **建議售價**
   - 根據所有輸入條件計算的預測價格
   - 模型準確度（R² 分數）

3. **市場價格統計**
   - 平均價格
   - 中位數價格
   - 最低/最高價格

4. **價格分群分析**
   - 視覺化圖表
   - 各價格區間的統計資訊

5. **市場參考價格**（如果有資料）
   - 蝦皮購物最新五筆
   - 露天拍賣最新五筆
   - 每筆包含商品標題、價格、連結

---

## ⚠️ 注意事項

### 1. 資料集準備
- 首次使用前必須執行 `prepare_iphone_dataset.py`
- 如果沒有資料集，系統會嘗試使用爬蟲，但可能無法取得資料

### 2. 爬蟲功能
- 系統會嘗試從蝦皮和露天爬取價格
- **如果爬蟲無法取得資料，會顯示「找不到」，不會使用虛擬資料**
- 爬蟲可能受到網站反爬蟲機制影響

### 3. 辨識限制
- 目前使用 YOLOv8 預訓練模型，主要辨識是否為手機
- 具體 iPhone 型號的辨識可能需要更專門的模型
- 如果無法辨識為 iPhone，會顯示錯誤頁面

### 4. 價格評估
- 價格評估基於資料集和機器學習模型
- 實際市場價格可能因地區、時間等因素而有所不同
- 建議售價僅供參考

---

## 🔧 技術架構

### 資料流程

1. **影像辨識** (`predict_iphone.py`)
   - 使用 YOLOv8 辨識是否為 iPhone
   - 嘗試識別具體型號

2. **資料獲取** (`data_engine.py`)
   - 從 `iphone.v1.csv` 載入資料
   - 或從蝦皮/露天爬取最新價格

3. **機器學習** (`model.py`)
   - K-Means 價格分群
   - Decision Tree 價格預測（使用 iPhone 專用特徵）

4. **結果展示** (`templates/result.html`)
   - 顯示評估結果
   - 市場參考價格
   - 視覺化圖表

---

## 📁 檔案結構

```
final_project/
├── app.py                      # Flask 主應用程式
├── predict_iphone.py          # iPhone 辨識模組
├── data_engine.py              # 資料獲取引擎
├── model.py                    # ML 模組
├── prepare_iphone_dataset.py   # 資料集準備腳本
├── iphone.v1.csv              # iPhone 資料集（執行腳本後產生）
├── templates/
│   ├── index.html             # 上傳介面
│   ├── result.html            # 結果頁面
│   └── error.html             # 錯誤頁面
└── requirements.txt           # 依賴套件
```

---

## 🚀 快速開始

1. **安裝依賴**
   ```bash
   pip install -r requirements.txt
   ```

2. **準備資料集**
   ```bash
   python prepare_iphone_dataset.py
   ```

3. **啟動系統**
   ```bash
   python app.py
   ```

4. **開啟瀏覽器**
   訪問 `http://localhost:5000`

---

## 📚 資料集說明

### iPhone 資料集 (`iphone.v1.csv`)

包含以下欄位：
- `model`: iPhone 型號
- `storage`: 儲存容量 (GB)
- `ram`: 記憶體 (GB)
- `screen_size`: 螢幕尺寸 (吋)
- `camera_mp`: 相機畫素 (MP)
- `battery_mah`: 電池容量 (mAh)
- `release_year`: 發布年份
- `base_price`: 基礎價格（新機價格）
- `condition`: 外觀狀況 (1-5)
- `screen_broken`: 螢幕是否破裂 (0/1)
- `camera_ok`: 鏡頭是否完好 (0/1)
- `battery_health`: 電池健康度 (0.0-1.0)
- `warranty_months`: 保固剩餘月數
- `price`: 二手價格

### 資料來源

資料集基於：
- iPhone 官方規格資料
- 市場價格趨勢
- 折舊計算公式
- 二手市場常見狀況

---

## 🔄 未來改進方向

1. **更精確的型號辨識**
   - 訓練專門的 iPhone 型號辨識模型
   - 使用 OCR 讀取型號文字

2. **更多資料來源**
   - 整合更多拍賣平台
   - 使用官方 API（如有提供）

3. **更準確的價格預測**
   - 加入更多特徵（顏色、配件等）
   - 使用更進階的 ML 模型

4. **即時市場資料**
   - 定期更新市場價格
   - 價格趨勢分析

---

**最後更新：** 2024年

